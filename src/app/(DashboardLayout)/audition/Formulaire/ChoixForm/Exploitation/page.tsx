'use client';

import { useRouter } from "next/navigation";
import { parseCookies } from "nookies";
import {  useState } from "react";

export default function Home () {


  const [exploitation, setExploitation] = useState<undefined | string >('');
  const [nombre, setNombre] = useState<undefined | string | number  >('');

  const router=useRouter();

            const handleSubmit =async (event:any)=> {
                event.preventDefault();
                const cookies = parseCookies();
                const id=cookies.id
                const exploitationData = {
                    Exploitation:exploitation,
                    Nombre:nombre,
                   Id_Audit:id

                };


const httpLink = 'http://127.0.0.1:1337/api/exploitations?populate=*';

const headerss = {
    'Accept': 'application/json',
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${cookies.jwt}`,
  };

  const body = JSON.stringify({ data: exploitationData });


  try {
    const response = await fetch(httpLink, {
      method: 'POST',
      headers: headerss,
      body: body,
  });

  const responseData = await response.json();
  router.push("/Formulaire/ChoixForm")
  console.log(responseData);
} catch (error) {
    console.error(error);
}



            }

    return (
        <div>
         <form onSubmit={handleSubmit}>

       <p> Exploitation :  <textarea required onChange={e=>setExploitation(e.target.value)} value={exploitation}  /> </p>
       <p> Nombre :  <input required onChange={e=>setNombre(e.target.value)} value={nombre} type="number" /> </p>

       <p> <button type="submit" >Confirmer</button></p>
         </form>
        </div>
    )
}
